<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Euystacio: Triple Anchor Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Inter:wght@300;400;600;700&display=swap');
        
        :root {
            --resonance-freq: 0.043Hz;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #0a0a0a;
            color: #e5e5e5;
            overflow-x: hidden;
        }

        .font-mono-custom { font-family: 'Space Mono', monospace; }
        
        .glass-panel {
            background: rgba(23, 23, 23, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glow-emerald { box-shadow: 0 0 20px rgba(16, 185, 129, 0.2); }
        
        @keyframes pulse-slow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .resonance-pulse { animation: pulse-slow 3s infinite ease-in-out; }

        .step-transition { transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- Background Resonance Signal -->
    <div class="fixed inset-0 pointer-events-none opacity-10">
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,#10b981_0%,transparent_50%)] resonance-pulse"></div>
    </div>

    <div id="terminal-container" class="max-w-2xl w-full glass-panel rounded-[2rem] shadow-2xl overflow-hidden relative z-10">
        
        <!-- Header -->
        <header class="p-6 border-b border-white/10 flex items-center justify-between bg-white/5">
            <div>
                <h1 class="text-xl font-bold tracking-tighter text-white">EUYSTACIO TERMINAL</h1>
                <p class="text-[10px] font-mono-custom text-emerald-500 uppercase tracking-[0.3em]">Resonance School Protocol v1.4</p>
            </div>
            <div class="text-right">
                <div class="text-[10px] text-white/40 font-mono-custom">ARCHIVE: BOLZANO_71</div>
                <div class="text-[10px] text-white/40 font-mono-custom" id="current-time"></div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="p-8">
            
            <!-- STEP 1: Passphrase & Physical Anchor -->
            <div id="step-1" class="step-transition">
                <div class="bg-red-500/10 border border-red-500/30 p-4 rounded-2xl mb-8 flex items-start gap-4">
                    <span class="text-xl">⚠️</span>
                    <div>
                        <p class="text-red-400 font-bold text-sm">FASE 1: ANCORAGGIO FISICO</p>
                        <p class="text-red-200/70 text-xs">Wittfrida Mitterer + 5 Testimoni: Verificare l'Archivio di Via Portici 71.</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <p class="text-sm text-neutral-400 leading-relaxed">
                        Per generare il legame tra l'evidenza fisica e la catena logica, è necessaria la trascrizione manuale di una passphrase non ripetibile.
                    </p>
                    
                    <button onclick="startAnchor()" id="btn-start" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-5 rounded-2xl shadow-lg transition-all active:scale-95 text-lg uppercase tracking-widest glow-emerald">
                        Inizia Convalida
                    </button>
                </div>
            </div>

            <!-- STEP 2: The Passphrase Display (Hidden initially) -->
            <div id="step-2" class="hidden step-transition">
                <div class="text-center space-y-6">
                    <p class="text-emerald-500 font-bold text-sm">✅ GENERAZIONE COMPLETATA</p>
                    
                    <div class="space-y-2">
                        <label class="text-[10px] uppercase text-neutral-500 font-bold tracking-widest">Trascrizione Manuale Obbligatoria</label>
                        <div id="passphrase-display" class="bg-black/50 border border-emerald-500/50 text-emerald-400 font-mono-custom p-6 rounded-2xl text-2xl tracking-tighter shadow-inner">
                            ---- ---- ----
                        </div>
                    </div>

                    <div class="bg-white/5 p-4 rounded-xl text-left border border-white/10">
                        <p class="text-xs text-neutral-300 leading-relaxed">
                            <strong>Istruzioni per Wittfrida:</strong> Scrivere a mano questa sequenza sul documento d'archivio. Firmare insieme ai 5 testimoni. Una volta fatto, procedere al caricamento fotografico.
                        </p>
                    </div>

                    <button onclick="goToUpload()" class="w-full bg-white text-black font-bold py-4 rounded-xl hover:bg-neutral-200 transition-colors uppercase text-sm tracking-widest">
                        Documento Firmato: Vai al Caricamento
                    </button>
                </div>
            </div>

            <!-- STEP 3: Photo Upload -->
            <div id="step-3" class="hidden step-transition">
                <div class="space-y-6">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-8 h-8 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-500 font-bold text-sm">2</div>
                        <h2 class="font-bold text-lg">Sigillo Digitale</h2>
                    </div>

                    <label class="block cursor-pointer">
                        <div class="border-2 border-dashed border-white/20 hover:border-emerald-500/50 bg-white/5 rounded-3xl p-12 transition-all flex flex-col items-center gap-4 text-center">
                            <div class="w-16 h-16 bg-emerald-500/10 rounded-full flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="text-emerald-500" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
                            </div>
                            <div>
                                <span class="text-emerald-500 font-bold block">Carica Foto Archivio</span>
                                <span class="text-neutral-500 text-[10px] uppercase">JPG, PNG - BIOMETRIC SCAN ACTIVE</span>
                            </div>
                        </div>
                        <input type="file" class="hidden" accept="image/*" onchange="processVerification(this)">
                    </label>
                </div>
            </div>

            <!-- STEP 4: Verifying/Success -->
            <div id="step-4" class="hidden step-transition">
                <div id="verifying-ui" class="text-center py-10 space-y-6">
                    <div class="inline-block w-16 h-16 border-4 border-emerald-500/20 border-t-emerald-500 rounded-full animate-spin"></div>
                    <p class="font-mono-custom text-emerald-500 text-xs animate-pulse tracking-widest">
                        SCANNING BIOMETRIC ANCHORS...
                    </p>
                    <div id="log-display" class="text-[9px] font-mono-custom text-neutral-600 text-left max-w-xs mx-auto space-y-1"></div>
                </div>

                <div id="success-ui" class="hidden text-center py-6 space-y-8">
                    <div class="inline-flex items-center justify-center w-24 h-24 bg-emerald-500/20 rounded-full border-4 border-emerald-500/50 text-emerald-500">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                    </div>
                    
                    <div>
                        <h2 class="text-2xl font-bold text-white mb-2">ANCORAGGIO ETERNO</h2>
                        <p class="text-neutral-400 text-sm">L'evidenza fisica è stata sigillata nella ESC Chain.</p>
                    </div>

                    <div class="bg-black/40 p-5 rounded-2xl border border-white/10 text-left font-mono-custom text-[9px] text-neutral-500 space-y-1">
                        <p>PROVA_LOGICA: <span id="final-hash" class="text-emerald-500/70"></span></p>
                        <p>TIMESTAMP: <span id="final-ts"></span></p>
                        <p>TESTIMONI: WITTFRIDA_M + 5_SIGN</p>
                        <p>STATUS: CONSENSUS_SACRALIS_LOCKED</p>
                    </div>

                    <button onclick="location.reload()" class="text-emerald-500 text-[10px] font-bold uppercase tracking-widest hover:text-emerald-400">
                        Inizia Nuovo Ciclo di Test
                    </button>
                </div>
            </div>

        </main>

        <!-- Footer -->
        <footer class="p-6 bg-black/50 border-t border-white/5 text-center">
            <p class="text-[9px] text-neutral-500 tracking-[0.4em] font-bold resonance-pulse">
                TRIPLE ANCHOR | JAN 10 MILESTONE
            </p>
        </footer>
    </div>

    <script>
        // Update Clock
        setInterval(() => {
            document.getElementById('current-time').innerText = new Date().toISOString().split('T')[1].split('.')[0] + ' UTC';
        }, 1000);

        function showStep(stepNum) {
            [1, 2, 3, 4].forEach(n => {
                document.getElementById(`step-${n}`).classList.add('hidden');
            });
            document.getElementById(`step-${stepNum}`).classList.remove('hidden');
        }

        function startAnchor() {
            const words = ["FUOCO", "ETICA", "PACEM", "VERITAS", "ANCORA", "OARALLIS", "RESONA", "SEMEN"];
            const passphrase = Array.from({length: 4}, () => words[Math.floor(Math.random() * words.length)]).join(' - ');
            document.getElementById('passphrase-display').innerText = passphrase;
            showStep(2);
        }

        function goToUpload() {
            showStep(3);
        }

        function processVerification(input) {
            if (!input.files || !input.files[0]) return;
            
            showStep(4);
            const logs = [
                "DETECTING WITTFRIDA_M SIGNATURE...",
                "VERIFYING 5 WITNESS BLOCK...",
                "OCR PASSPHRASE MATCH: SUCCESS",
                "GEOLOCATION SYNC: BOLZANO_71",
                "HANNES_MITTERER VETO CHECK: CLEAR",
                "GENERATING KECCAK256 HASH..."
            ];
            
            const logDisplay = document.getElementById('log-display');
            logs.forEach((text, i) => {
                setTimeout(() => {
                    const p = document.createElement('p');
                    p.innerText = `> ${text}`;
                    logDisplay.appendChild(p);
                }, i * 600);
            });

            setTimeout(() => {
                document.getElementById('verifying-ui').classList.add('hidden');
                document.getElementById('success-ui').classList.remove('hidden');
                document.getElementById('final-hash').innerText = '0x' + Math.random().toString(16).substring(2, 15).toUpperCase();
                document.getElementById('final-ts').innerText = new Date().toISOString();
            }, (logs.length * 600) + 500);
        }
    </script>
</body>
</html>
